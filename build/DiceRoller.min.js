/*! DiceRoller 2014-06-13 */
!function(a,b){"use strict";console.log("diceroller.js");var c=function(a){if(!a){var b={DiceSides:100,Percentual:!0,BaseSkill:0,OpenRoll:!1,BonusSkill:0,HistoryBox:"RollBox",CriticalTreshold:10,CriticalMultiplier:2,CriticalPierceArmor:!1,SpecialRoll:!1,SpecialRollMultiplier:0,SpecialRollTreshold:0,SpecialRollPierceArmor:!1,EpicFail:!0,EpicFailTreshold:5,EpicFailMaxTreshold:100,EpicFailMinTreshold:100,DirectFail:96};a=b}return new d(a)},d=function(a){return this.DiceSides=a.DiceSides,this.Percentual=a.Percentual,this.BaseSkill=a.BaseSkill,this.BonusSkill=a.BonusSkill,this.BonusPenalty=a.BonusPenalty,this.CriticalTreshold=a.CriticalTreshold,this.CriticalMultiplier=a.CriticalMultiplier,this.CriticalPierceArmor=a.CriticalPierceArmor,this.SpecialRoll=a.SpecialRoll,this.SpecialRollMultiplier=a.SpecialRollMultiplier,this.SpecialRollTreshold=a.SpecialRollTreshold,this.SpecialRollPierceArmor=a.SpecialRollPierceArmor,this.EpicFail=a.EpicFail,this.EpicFailTreshold=a.EpicFailTreshold,this.EpicFailMaxTreshold=a.EpicFailMaxTreshold,this.EpicfailMinTreshold=a.EpicfailMinTreshold,this.OpenRoll=a.OpenRoll,this.HistoryBox=a.HistoryBox,this.DirectFail=a.DirectFail,this.CalcTresholds=function(){function b(){return Math.floor((f.BaseSkill+a.BonusSkill)/100*a.CriticalTreshold)}function c(){return Math.floor((f.BaseSkill+a.BonusSkill)/100*a.SpecialRollTreshold)}function d(){var b=-1*Math.floor((f.BaseSkill+a.BonusSkill)/a.EpicFailTreshold)+100;return b<a.EpicFailMinTreshold?a.EpicFailMinTreshold:b}function e(a){f.BaseSkill=a}var f={};return{critical_value:b,special_value:c,critical_fail_value:d,setArgs:e}}(a),this.roller=function(a,b){var c=[];Math.seedrandom("added entropy.",{entropy:!0}),null===a&&(a=this.DiceSides);for(var d=0;b>d;d++)c.push(1+Math.floor(Math.random()*a));return c},this};c.fn=d.prototype={roll:function(a,c,d){var e=0,f=this.HistoryBox,g=document.getElementById(f),h=document.createElement("p");(null===c||""===c||c===b)&&(c=this.DiceSides),(null===d||""===d||d===b)&&(d=0);for(var i=this.roller(c,a),j=i.length-1;j>=0;j--)e+=+i[j],h.innerHTML+=j===i.length-1?' &nbsp; <span class="lbox lbox-default">'+i[j]+"</span>":' &nbsp; +  &nbsp; <span class="lbox lbox-default">'+i[j]+"</span>";return h.setAttribute("name","logrow"),0!==d?(e+=d,h.innerHTML+=' &nbsp; +  &nbsp; <span class="lbox lbox-warning">'+d+"</span>",h.innerHTML+=' &nbsp; =  &nbsp; <span class="lbox lbox-success">'+e+"</span>"):h.innerHTML+=' &nbsp; =  &nbsp; <span class="lbox lbox-success">'+e+"</span>",g.appendChild(h),g.scrollTop=g.scrollHeight,this},skill:function(a,c,d,e,f){(0===c||c===b)&&(c=this.DiceSides),(e===!1||e===b)&&(e=this.BaseSkill),(0===d||d===b)&&(d=this.BonusSkill),(""===f||f===b||f===!1)&&(f=0);var g=this.roller(c,a),h=e+d,i=document.getElementById(this.HistoryBox),j=document.createElement("p"),k={},l={Critical:function(){var a=Math.floor((e+d)*(this.CriticalTreshold/100));return 0>=a&&(a=1),a}.bind(this),EpicFail:function(){var a=Math.floor((e+d)*(this.EpicFailTreshold/100));return a=100-a,a<this.EpicFailMaxTreshold&&(a=this.EpicFailMaxTreshold),a}.bind(this),SpecialRoll:function(){var a=Math.floor((e+d)*(this.SpecialRollTreshold/100)),b=a-l.Critical()+1;return{MinSpecial:b,MaxSpecial:a}}.bind(this)};if(this.Percentual){console.log("BRP");var m=l.SpecialRoll();g<=l.Critical()&&0!==g&&g<this.DirectFail?(j.innerHTML='<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+=0!==d?'&nbsp; <span class="lbox lbox-default">Roll Mod: '+d+"</span>":'<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+='&nbsp; <span class="lbox lbox-success">'+g+"&nbsp; Critical! </span>",k={Roll:g[0],Critical:!0,Special:!1,EpicFail:!1,Fail:!1}):g>=m.MinSpecial&&g<=m.MaxSpecial&&g<this.DirectFail&&this.SpecialRoll?(j.innerHTML='<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+=0!==d?'&nbsp; <span class="lbox lbox-default">Roll Mod: '+d+"</span>":'<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+='&nbsp; <span class="lbox lbox-success">'+g+"&nbsp; Special! </span>",k={Roll:g[0],Critical:!1,Special:!0,EpicFail:!1,Fail:!1}):g>=l.EpicFail()?(j.innerHTML='<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+=0!==d?'&nbsp; <span class="lbox lbox-default">Roll Mod: '+d+"</span>":'<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+='&nbsp; <span class="lbox lbox-danger">'+g+"&nbsp; Epic Fail! </span>",k={Roll:g[0],Critical:!1,Special:!1,EpicFail:!0,Fail:!0}):h>=g&&g<this.DirectFail?(j.innerHTML='<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+=0!==d?'&nbsp; <span class="lbox lbox-default">Roll Mod: '+d+"</span>":'<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+='&nbsp; <span class="lbox lbox-success">'+g+"&nbsp; Success! </span>",k={Roll:g[0],Critical:!1,Special:!1,EpicFail:!1,Fail:!1}):(j.innerHTML='<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+=0!==d?'&nbsp; <span class="lbox lbox-default">Roll Mod: '+d+"</span>":'<span class="lbox lbox-info">Roll Skill: '+h+"</span>",j.innerHTML+='&nbsp; <span class="lbox lbox-danger">'+g+"&nbsp; Fail! </span>",k={Roll:g[0],Critical:!1,Special:!1,EpicFail:!1,Fail:!0})}if(!this.Percentual){console.log("MERP");var n=[],o=0,p=0;if(g>=96){n.push(g[0]);a:for(;;){if(g=this.roller(c,a),!(g>=96)){n.push(g[0]);break a}n.push(g[0])}for(p=0;p<=n.length-1;p++)j.innerHTML+=0===p?['<span class="lbox lbox-info"> Open Roll!</span>','&nbsp; <span class="lbox lbox-default">',n[p]+"</span>"].join("\n"):'&nbsp; + &nbsp; <span class="lbox lbox-default">'+n[p]+"</span>",o+=parseInt(n[p],10);o+d>f?0!==d&&"number"==typeof d?(o+=d,j.innerHTML+=['&nbsp; + &nbsp; <span class="lbox lbox-default">Roll Mod '+d+"</span>",'&nbsp; &nbsp; <span class="lbox lbox-info">Difficulty '+f+"</span>",'&nbsp; = &nbsp; <span class="lbox lbox-success">'+o+"</span>",'&nbsp; <span class="lbox lbox-warning">Critical Roll !!</span>'].join("\n")):j.innerHTML+=['&nbsp; &nbsp; <span class="lbox lbox-info">Difficulty '+f+"</span>",'&nbsp; = &nbsp; <span class="lbox lbox-success">'+o,'</span> &nbsp; <span class="lbox lbox-warning">Critical Roll !!</span>'].join("\n"):j.innerHTML+=['&nbsp; + &nbsp; <span class="lbox lbox-default">Roll Mod '+d+"</span>",'&nbsp; &nbsp; <span class="lbox lbox-info">Difficulty '+f+"</span>",'&nbsp; = &nbsp; <span class="lbox lbox-danger">'+o+"  &nbsp; Failed!</span>"].join("\n")}else if(5>=g&&0!==g){n.push(g[0]);a:for(;;){if(g=this.roller(c,a),96>=g&&0!==g){n.push(-g[0]);break a}n.push(-g[0])}for(p=0;p<=n.length-1;p++)j.innerHTML+=0===+p?['&nbsp; <span class="lbox lbox-info"> Open Roll!</span>','&nbsp; <span class="lbox lbox-default">',n[p]+"</span>"].join("\n"):'&nbsp; + &nbsp; <span class="lbox lbox-default">'+n[p]+"</span>",o+=parseInt(n[p],10);0!==d&&"number"==typeof d?(o+=d,j.innerHTML+=['&nbsp; + &nbsp; <span class="lbox lbox-default">Roll Mod '+d+"</span>",'&nbsp; = &nbsp;<span class="lbox lbox-danger">'+o,"&nbsp; Epic Fail !!</span>"].join("\n")):j.innerHTML+=['&nbsp; = &nbsp; <span class="lbox lbox-danger">'+o,"Epic Fail !!</span>"].join("\n")}else{var q=g[0];j.innerHTML+=['&nbsp; <span class="lbox lbox-info">Roll!</span>','&nbsp; <span class="lbox lbox-default">'+g+"</span>"].join("\n"),0!==d&&"number"==typeof d?(j.innerHTML+=['&nbsp; + &nbsp; <span class="lbox lbox-default">Roll Mod '+d+"</span>",'&nbsp; &nbsp; <span class="lbox lbox-info">Difficulty '+f+"</span>"].join("\n"),q+=d,j.innerHTML+=q+d>f?'&nbsp; = &nbsp; <span class="lbox lbox-success">'+q+" &nbsp; Roll Success</span>":'&nbsp; = &nbsp; <span class="lbox lbox-danger">'+q+"  &nbsp; Failed!</span>"):(j.innerHTML+='&nbsp; &nbsp; <span class="lbox lbox-info">Difficulty '+f+"</span>",j.innerHTML+=g>f?'&nbsp; = &nbsp; <span class="lbox lbox-success">'+g+" &nbsp; Roll Success</span>":'&nbsp; = &nbsp; <span class="lbox lbox-danger">'+g+"  &nbsp; Failed!</span>")}}return i.appendChild(j),i.scrollTop=i.scrollHeight,{RollsObj:k,"this":this}},armor:function(a,c){function d(a,b,c){var d={},e={};for(var f in a)if(a.hasOwnProperty(f))for(var g in a[f]){var h=a[f][g].Name.toLowerCase();d[h]={Name:a[f][g].Name.toLowerCase(),Sides:a[f][g].Sides,Rolls:a[f][g].Rolls,Fixed:a[f][g].Fixed}}if(b.hasOwnProperty("TypeDamage")){var h=b.TypeDamage.toLowerCase();e[h]={Name:b.TypeDamage.toLowerCase(),Sides:b.Sides,Rolls:b.Rolls,Damage:b.Damage,ModDamage:b.ModDamage,Special:b.Special,Critical:b.Critical},e[h].Damage=e[h].Critical?+e[h].Damage*c.CriticalMultiplier:e[h].Special?+e[h].Damage*c.SpecialRollMultiplier:e[h].Damage}else for(var f in b)if(b.hasOwnProperty(f)){var h=b[f].TypeDamage.toLowerCase();e[h]={Name:b[f].TypeDamage.toLowerCase(),Sides:b[f].Sides,Rolls:b[f].Rolls,Damage:b[f].Damage,ModDamage:b[f].ModDamage}}return{ArmorParams:d,FullDamage:e}}var e=this.HistoryBox,f=document.getElementById(e),g=document.createElement("p"),h=[],i=0,j=0,k={},l={};"FullDamage"===Object.keys(c)[0]?(k=c.FullDamage,l=c.this):(k=c,l=this);var m=d(a,k,l),n=m.ArmorParams,o=m.FullDamage,p=0,q=function(a,c,d){(a===b||""===a)&&(a=0);var e=d-(+a+c);return 0>e?0:e};for(var r in n)if(n.hasOwnProperty(r))for(var s in o)if(o.hasOwnProperty(s))try{if(n[r].Name===o[s].Name){if(h=this.roller(n[r].Sides,n[r].Rolls),o[s].Damage.length>1){p=0;for(var t=0;t<o[s].Damage.length;t++)p+=o[s].Damage[t];p+=o[s].ModDamage}else j="undefined"==typeof o[s].Damage[0]?+o[s].Damage+o[s].ModDamage:+o[s].Damage[0]+o[s].ModDamage;if(n[r].Name===o[s].Name&&n[r].Sides>0&&n[r].Rolls>0)if(g.innerHTML+=['<span class="lbox lbox-info">'+n[r].Name+" Armor","&nbsp; "+n[r].Rolls+"d"+n[r].Sides,"</span>"].join("\n"),h.length>1){for(var u=0;u<h.length;u++)i+=parseInt(h[u],10);g.innerHTML+=['&nbsp : &nbsp<span class="lbox lbox-default">Dice Armor: '+i+"</span>",'&nbsp + &nbsp<span class="lbox lbox-default">Fixed Armor: '+n[r].Fixed+"</span>"].join("\n"),g.innerHTML+=o[s].Damage.length>1?['&nbsp - &nbsp<span class="lbox lbox-warning">Damage incoming: '+p+"</span>",'&nbsp = &nbsp<span class="lbox lbox-success"> Total: '+q(i,n[s].Fixed,p),"</span></br>"].join("\n"):['&nbsp - &nbsp<span class="lbox lbox-warning">Damage incoming: '+j+"</span>",'&nbsp = &nbsp<span class="lbox lbox-success"> Total: '+q(i,n[s].Fixed,j),"</span></br>"].join("\n"),i=0}else g.innerHTML+=['&nbsp : &nbsp<span class="lbox lbox-default">Dice Armor: '+h+"</span>",'&nbsp + &nbsp<span class="lbox lbox-default">Fixed Armor: '+n[r].Fixed+"</span>"].join("\n"),g.innerHTML+=o[s].Damage.length>1?['&nbsp - &nbsp<span class="lbox lbox-warning">Damage incoming: '+p+"</span>",'&nbsp = &nbsp<span class="lbox lbox-success"> Total: '+q(h,n[s].Fixed,p),"</span></br>"].join("\n"):['&nbsp - &nbsp<span class="lbox lbox-warning">Damage incoming: '+j+"</span>",'&nbsp = &nbsp<span class="lbox lbox-success"> Total: '+q(h,n[s].Fixed,j),"</span></br>"].join("\n");(0===n[r].Rolls&&0===n[r].Sides&&n[r].Fixed>0||n[r].Fixed<0)&&(g.innerHTML+=['<span class="lbox lbox-info">'+n[s].Name+" Armor </span>",'&nbsp : <span class="lbox lbox-default">Fixed Armor : '+n[s].Fixed+"</span>",'&nbsp + &nbsp<span class="lbox lbox-warning">Damage incoming: '+j+"</span>",'&nbsp = &nbsp<span class="lbox lbox-success"> Total: '+q(0,n[s].Fixed,j),"</span></br>"].join("\n"))}}catch(v){console.log(v)}return f.appendChild(g),f.scrollTop=f.scrollHeight,this},damage:function(a,b,c){function d(a,b,c){var d=/,/g,e=0,f=0,g=[],h={criticalmod:function(a){return Math.floor(a*c.CriticalMultiplier)}.bind(c),specialmod:function(a){return Math.floor(a*c.SpecialRollMultiplier)}.bind(c)};return"critical"===a?(g=b.map(h.criticalmod),e=g.toString(),f=e.replace(d,"&nbsp; & &nbsp;"),f):"special"===a?(g=b.map(h.specialmod),e=g.toString(),f=e.replace(d,"&nbsp; & &nbsp;"),f):"normal"===a?(g=b,e=g.toString(),f=e.replace(d,"&nbsp; & &nbsp;"),f):(console.log("Error!! cannot leave args blank, or wrong assingment"),0)}for(var e=[],f=this.HistoryBox,g=document.getElementById(f),h=document.createElement("p"),i=0,j={},k=0,l=[],m=0,n=0,o=0,b=b.RollsObj,p=this,q=0;q<=a.Sides.length-1;q++)e.push(this.roller(a.Sides[q],a.Rolls[q]));for(var r=0;r<=a.Sides.length-1;r++)j[r]={Sides:a.Sides[r],Rolls:a.Rolls[r],Damage:e[r],ModDamage:a.ModDamage[r],Critical:b.Critical,Special:b.Special,TypeDamage:a.TypeDamage[r]};if(c){for(var s in j)if(j.hasOwnProperty(s))if(j[s].Damage.length>1){for(var t=0;t<j[s].Damage.length;t++)k+=+j[s].Damage[t];l.push(b.Critical?k*+this.CriticalMultiplier:b.Special?Math.floor(k*+this.SpecialRollMultiplier):k),k=0}else b.Critical?(k+=j[s].Damage*this.CriticalMultiplier,l.push(k)):b.Special?(k+=Math.floor(j[s].Damage*this.SpecialRollMultiplier),l.push(k)):(k+=+j[s].Damage,l.push(k)),k=0;if(a.ModDamage.length>1)for(var u=0;u<l.length;u++)n=j[u].Damage,h.innerHTML+=['<span class="lbox lbox-info">',a.Rolls[u]+"d"+a.Sides[u]+"</span> &nbsp;"].join("\n"),b.Critical?(o=d("critical",n,p),i=l[u]+a.ModDamage[u]*+this.CriticalMultiplier,h.innerHTML+=['<span class="lbox lbox-warning"> Critical x'+this.CriticalMultiplier+"</span>",'<span class="lbox lbox-default">Rolls for a  : &nbsp;',o+"</span>",'<span class="lbox lbox-info">'+j[u].TypeDamage+" &nbsp; Damage</span>"].join("\n")):b.Special?(o=d("special",n,p),i=l[u]+Math.floor(a.ModDamage[u])*+this.SpecialRollMultiplier,h.innerHTML+=['<span class="lbox lbox-warning"> Special x'+this.SpecialRollMultiplier+"</span>",'<span class="lbox lbox-default">Rolls for a  : &nbsp;',o+"</span>",'<span class="lbox lbox-info">'+j[u].TypeDamage+" &nbsp; Damage</span>"].join("\n")):(o=d("normal",n,p),i=parseInt(l[u],10)+parseInt(a.ModDamage[u],10),h.innerHTML+=['<span class="lbox lbox-default">Rolls for : &nbsp;',o+"</span>",'<span class="lbox lbox-info">'+j[u].TypeDamage+" &nbsp; Damage</span>"].join("\n")),m+=i,a.ModDamage[u]<0?(h.innerHTML+=b.Critical?['&nbsp;<span class="lbox lbox-danger ">',+a.ModDamage[u]*this.CriticalMultiplier+"</span>"].join("\n"):b.Special?['&nbsp;<span class="lbox lbox-danger ">',Math.floor(+a.ModDamage[u]*this.SpecialRollMultiplier)+"</span>"].join("\n"):['&nbsp;<span class="lbox lbox-danger ">',a.ModDamage[u]+"</span>"].join("\n"),h.innerHTML+='&nbsp; = &nbsp;<span class="lbox lbox-default">'+i+"</span></br>"):a.ModDamage[u]>0&&(h.innerHTML+=b.Critical?['&nbsp;<span class="lbox lbox-primary ">'," + "+ +a.ModDamage[u]*this.CriticalMultiplier+"</span>"].join("\n"):b.Special?['&nbsp;<span class="lbox lbox-primary ">'," + "+Math.floor(+a.ModDamage[u]*this.SpecialRollMultiplier)+"</span>"].join("\n"):['&nbsp;<span class="lbox lbox-primary ">'," + "+a.ModDamage[u]+"</span>"].join("\n"),h.innerHTML+='&nbsp; = &nbsp;<span class="lbox lbox-default">'+i+"</span></br>");c&&(h.innerHTML+=this.CriticalPierceArmor&&b.Critical?['</br><span class="lbox lbox-success">',"Total : "+m+"</span>",'<span class="lbox lbox-warning">Armor is ignored</span>'].join("\n"):['</br><span class="lbox lbox-success">',"Total : "+m+"</span>"].join("\n"),g.appendChild(h),g.scrollTop=g.scrollHeight)}return{FullDamage:j,"this":this}},d20:function(a){var b=this.HistoryBox,c=document.getElementById(b),d=document.createElement("p"),e=[],f=[],g=0;f=this.roller(a.Sides,a.Rolls);var h=function(b){var c=[],d=b;return c=this.roller(a.Sides,a.Rolls),1===b[0]?1===c[0]&&d.length<=2&&(d.push(c[0]),h(d)):b[0]>=20&&3!==d.length&&(c[0]>=20&&d.length<=3?(d.push(c[0]),h(d)):d.push(c[0])),d}.bind(this),i=function(a){var b=/,/g,c=0,d=0;return c=a.toString(),d=c.replace(b,"&nbsp; & &nbsp;")};d.innerHTML+=['<span class="lbox lbox-info">Rolls a ',a.Rolls+"d"+a.Sides+"</span> &nbsp;",'<span class="lbox lbox-default"> Difficulty of',a.Difficulty+"</span>"].join("\n"),a.Mod&&(d.innerHTML+=['&nbsp; <span class="lbox lbox-default"> Modificators &nbsp;',a.Mod+"</span>"].join("\n"),g=f[0]+a.Mod),f[0]>=a.Difficulty&&f[0]<a.Critical&&20!==f[0]&&0===g?(d.innerHTML+=['&nbsp; <span class="lbox lbox-info">Roll Result '+f[0]+"</span>",'&nbsp; <span class="lbox lbox-success"> Success! '+f[0]+a.Mod+"</span>"].join("\n"),console.log("Success "+f[0])):g>=a.Difficulty&&f[0]<a.Critical&&20!==f[0]?(d.innerHTML+=['&nbsp; <span class="lbox lbox-info">Roll Result '+f[0]+"</span>",'&nbsp; <span class="lbox lbox-success"> Success! '+g+"</span>"].join("\n"),console.log("Success "+f[0])):f[0]>=a.Critical&&f[0]>=a.Difficulty||g>=a.Critical&&g>=a.Difficulty||20===f[0]?(e.push(f[0]),20===f[0]?(e=h(f),console.log(e)):(f.length=0,f=this.roller(a.Sides,a.Rolls),e.push(f[0])),console.log(e),20===e[2]?(d.innerHTML+=a.Mod?['&nbsp; <span class="lbox lbox-info">Astonishing three twentys!!!</span>','<span class="lbox lbox-default">First Roll&nbsp;'+e[0]+"&nbsp; plus mods =&nbsp;",g+"</span>",'&nbsp; <span class="lbox lbox-success">Critical Success!! '+i(e)+"</span>"].join("\n"):'&nbsp; <span class="lbox lbox-warning">Astonishing Critical!! '+i(e)+"</span>",console.log("Brutal!! three 20!! "+e)):e[0]<20&&e[1]>=a.Critical&&e[1]>=a.Difficulty&&e[2]<a.Critical?(d.innerHTML+=a.Mod?['&nbsp; <span class="lbox lbox-info">Two 20! But third one never appeared</span>','<span class="lbox lbox-default">First Roll&nbsp;'+e[0]+"&nbsp; plus mods =&nbsp;",g+"</span>",'&nbsp; <span class="lbox lbox-success">Critical Success!! '+i(e)+"</span>"].join("\n"):'&nbsp; <span class="lbox lbox-success">Critical!! '+i(e)+"</span>",console.log("Critical! "+e)):e[0]>=a.Critical&&e[1]>=a.Critical&&e[1]>=a.Difficulty?(d.innerHTML+=a.Mod?['&nbsp; <span class="lbox lbox-info">Second Roll confirms critical</span>','<span class="lbox lbox-default">First Roll&nbsp;'+e[0]+"&nbsp; plus mods =&nbsp;",g+"</span>",'&nbsp; <span class="lbox lbox-success">Critical Success!! '+i(e)+"</span>"].join("\n"):'&nbsp; <span class="lbox lbox-success">Critical!! '+i(e)+"</span>",console.log("Critical! "+e)):e[1]<a.Critical&&(d.innerHTML+=a.Mod?['&nbsp; <span class="lbox lbox-info">A possible Critical Roll',"but 2nd roll failed, Roll Result = "+i(e)+"</span>",'&nbsp; <span class="lbox lbox-success">Success!! '+g+"</span>"].join("\n"):'&nbsp; <span class="lbox lbox-success">Success!! '+i(e)+"</span>",console.log("Success! "+e))):1===f[0]?(e=h(f),1===e[1]?(d.innerHTML+='&nbsp; <span class="lbox lbox-danger">Epic Fail!! '+i(e)+"</span>",console.log("Epic Fail!! "+e)):(d.innerHTML+=['&nbsp; <span class="lbox lbox-info">Natural 1 Roll means direct fail</span>','&nbsp; <span class="lbox lbox-danger">Fail!! '+i(e)+"</span>"].join("\n"),console.log("Fail!! "+e))):(d.innerHTML+=a.Mod?['&nbsp; <span class="lbox lbox-info">Failed roll',"First Roll&nbsp;"+f[0]+"&nbsp; plus mods =&nbsp;",g+"</span>",'&nbsp; <span class="lbox lbox-danger">Fail!! '+g+"</span>"].join("\n"):'&nbsp; <span class="lbox lbox-danger">Faill!! '+f[0]+"</span>",console.log("Fail! "+f[0])),c.appendChild(d),c.scrollTop=c.scrollHeight},confront:function(a,b){var c=this.HistoryBox,d=document.getElementById(c),e=document.createElement("p"),f=0,g=0,h={},i=0,j=0,k=0;return f=5*(a-b)+50,g=this.roller(this.DiceSides,1),this.CalcTresholds.setArgs(f),i=this.CalcTresholds.critical_value(),j=this.CalcTresholds.special_value(),k=this.CalcTresholds.critical_fail_value(h),f>0&&(e.innerHTML=['<span class="lbox lbox-info">Confront '+a+" vs "+b+"</span>",'&nbsp;<span class="lbox lbox-default">percentaje to roll '+f+"</span>"].join("\n")),f>=g&&g>i&&g>j&&f>0&&g<this.DirectFail?e.innerHTML+='&nbsp;<span class="lbox lbox-success">Rolls for '+g+", Success!!</span>":g>=i&&i>=g&&f>0?e.innerHTML+='&nbsp;<span class="lbox lbox-success">Rolls for '+g+", Critical!!</span>":g>i&&g>=j&&j>=g&&0!==j&&f>0?e.innerHTML+='&nbsp;<span class="lbox lbox-success">Rolls for '+g+", Special!!</span>":g>=k&&f>0?e.innerHTML+='&nbsp;<span class="lbox lbox-danger">Rolls for '+g+", Critical Fail!!</span>":0===f||0>f?e.innerHTML='&nbsp;<span class="lbox lbox-danger">Automatic Fail!! you donÂ´t have a chance!!</span>':e.innerHTML+='&nbsp;<span class="lbox lbox-danger">Rolls for '+g+", Fail!!</span>",d.appendChild(e),d.scrollTop=d.scrollHeight,this}},a.D||(a.D=c)}(window);